{"version":3,"sources":["modules/select.js"],"names":["angular","trigger","provider","container","this","defaults","keyboard","html","delay","multiple","allNoneButtons","sort","caretHtml","placeholder","allText","noneText","maxLength","maxLengthHtml","iconCheckmark","isNative","isTouch","SelectFactory","$select","options","$get","scope","$scope","$activeIndex","config","$tooltip","element","$isMultiple","$showAllNoneButtons","$iconCheckmark","$allText","$activate","activate","index","$$postDigest","select","evt","$isActive","$isVisible","i","$selectNone","$matches","length","matches","$updateActiveIndex","splice","a","indexOf","push","b","controller","value","$apply","$setViewValue","hide","prefixEvent","$emit","isArray","$modelValue","minLength","$viewValue","equals","$onMouseDown","preventDefault","stopPropagation","targetEl","keyCode","$onKeyDown","test","$digest","isUndefined","$selectScrollFix","$isIE","stopImmediatePropagation","target","focus","ua","_show","show","activeElement","tagName","e","$element","addClass","$timeout","_hide","on","off","directive","$window","document","link","require","restrict","forEach","attr","falseValueRegExp","isDefined","key","dataMultiple","nodeName","inputEl","css","after","addEventListener","watchedOptions","parsedOptions","valuesFn","update","values","ngModel","$match","newValue","oldValue","$render","selected","filter","join","map","$getIndex","label","$isEmpty","$on","destroy"],"mappings":"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","file":"modules/select.min.js","sourcesContent":["'use strict';\r\n\r\nangular.module('mgcrea.ngStrap.select', ['mgcrea.ngStrap.tooltip', 'mgcrea.ngStrap.helpers.parseOptions'])\r\n\r\n  .provider('$select', function () {\r\n\r\n    var defaults = this.defaults = {\r\n      animation: 'am-fade',\r\n      prefixClass: 'select',\r\n      prefixEvent: '$select',\r\n      placement: 'bottom-left',\r\n      templateUrl: 'select/select.tpl.html',\r\n      trigger: 'focus',\r\n      container: false,\r\n      keyboard: true,\r\n      html: false,\r\n      delay: 0,\r\n      multiple: false,\r\n      allNoneButtons: false,\r\n      sort: true,\r\n      caretHtml: '&nbsp;<span class=\"caret\"></span>',\r\n      placeholder: 'Choose among the following...',\r\n      allText: 'All',\r\n      noneText: 'None',\r\n      maxLength: 3,\r\n      maxLengthHtml: 'selected',\r\n      iconCheckmark: 'glyphicon glyphicon-ok'\r\n    };\r\n\r\n    this.$get = function ($window, $document, $rootScope, $tooltip, $timeout) {\r\n\r\n      // var bodyEl = angular.element($window.document.body);\r\n      var isNative = /(ip[ao]d|iphone|android)/ig.test($window.navigator.userAgent);\r\n      var isTouch = ('createTouch' in $window.document) && isNative;\r\n\r\n      function SelectFactory (element, controller, config) {\r\n\r\n        var $select = {};\r\n\r\n        // Common vars\r\n        var options = angular.extend({}, defaults, config);\r\n\r\n        $select = $tooltip(element, options);\r\n        var scope = $select.$scope;\r\n\r\n        scope.$matches = [];\r\n        if (options.multiple) {\r\n          scope.$activeIndex = [];\r\n        } else {\r\n          scope.$activeIndex = -1;\r\n        }\r\n        scope.$isMultiple = options.multiple;\r\n        scope.$showAllNoneButtons = options.allNoneButtons && options.multiple;\r\n        scope.$iconCheckmark = options.iconCheckmark;\r\n        scope.$allText = options.allText;\r\n        scope.$noneText = options.noneText;\r\n\r\n        scope.$activate = function (index) {\r\n          scope.$$postDigest(function () {\r\n            $select.activate(index);\r\n          });\r\n        };\r\n\r\n        scope.$select = function (index, evt) {\r\n          scope.$$postDigest(function () {\r\n            $select.select(index);\r\n          });\r\n        };\r\n\r\n        scope.$isVisible = function () {\r\n          return $select.$isVisible();\r\n        };\r\n\r\n        scope.$isActive = function (index) {\r\n          return $select.$isActive(index);\r\n        };\r\n\r\n        scope.$selectAll = function () {\r\n          for (var i = 0; i < scope.$matches.length; i++) {\r\n            if (!scope.$isActive(i)) {\r\n              scope.$select(i);\r\n            }\r\n          }\r\n        };\r\n\r\n        scope.$selectNone = function () {\r\n          for (var i = 0; i < scope.$matches.length; i++) {\r\n            if (scope.$isActive(i)) {\r\n              scope.$select(i);\r\n            }\r\n          }\r\n        };\r\n\r\n        // Public methods\r\n\r\n        $select.update = function (matches) {\r\n          scope.$matches = matches;\r\n          $select.$updateActiveIndex();\r\n        };\r\n\r\n        $select.activate = function (index) {\r\n          if (options.multiple) {\r\n            if ($select.$isActive(index)) {\r\n              scope.$activeIndex.splice(scope.$activeIndex.indexOf(index), 1);\r\n            } else {\r\n              scope.$activeIndex.push(index);\r\n            }\r\n            if (options.sort) scope.$activeIndex.sort(function (a, b) { return a - b; }); // use numeric sort instead of default sort\r\n          } else {\r\n            scope.$activeIndex = index;\r\n          }\r\n          return scope.$activeIndex;\r\n        };\r\n\r\n        $select.select = function (index) {\r\n          var value = scope.$matches[index].value;\r\n          scope.$apply(function () {\r\n            $select.activate(index);\r\n            if (options.multiple) {\r\n              controller.$setViewValue(scope.$activeIndex.map(function (index) {\r\n                if (angular.isUndefined(scope.$matches[index])) {\r\n                  return null;\r\n                }\r\n                return scope.$matches[index].value;\r\n              }));\r\n            } else {\r\n              controller.$setViewValue(value);\r\n              // Hide if single select\r\n              $select.hide();\r\n            }\r\n          });\r\n          // Emit event\r\n          scope.$emit(options.prefixEvent + '.select', value, index, $select);\r\n        };\r\n\r\n        // Protected methods\r\n\r\n        $select.$updateActiveIndex = function () {\r\n          if (options.multiple) {\r\n            if (angular.isArray(controller.$modelValue)) {\r\n              scope.$activeIndex = controller.$modelValue.map(function (value) {\r\n                return $select.$getIndex(value);\r\n              });\r\n            } else {\r\n              scope.$activeIndex = [];\r\n            }\r\n          } else {\r\n            if (angular.isDefined(controller.$modelValue) && scope.$matches.length) {\r\n              scope.$activeIndex = $select.$getIndex(controller.$modelValue);\r\n            } else {\r\n              scope.$activeIndex = -1;\r\n            }\r\n          }\r\n        };\r\n\r\n        $select.$isVisible = function () {\r\n          if (!options.minLength || !controller) {\r\n            return scope.$matches.length;\r\n          }\r\n          // minLength support\r\n          return scope.$matches.length && controller.$viewValue.length >= options.minLength;\r\n        };\r\n\r\n        $select.$isActive = function (index) {\r\n          if (options.multiple) {\r\n            return scope.$activeIndex.indexOf(index) !== -1;\r\n          }\r\n          return scope.$activeIndex === index;\r\n        };\r\n\r\n        $select.$getIndex = function (value) {\r\n          var index;\r\n          for (index = scope.$matches.length; index--;) {\r\n            if (angular.equals(scope.$matches[index].value, value)) break;\r\n          }\r\n          return index;\r\n        };\r\n\r\n        $select.$onMouseDown = function (evt) {\r\n          // Prevent blur on mousedown on .dropdown-menu\r\n          evt.preventDefault();\r\n          evt.stopPropagation();\r\n          // Emulate click for mobile devices\r\n          if (isTouch) {\r\n            var targetEl = angular.element(evt.target);\r\n            targetEl.triggerHandler('click');\r\n          }\r\n        };\r\n\r\n        $select.$onKeyDown = function (evt) {\r\n          if (!/(9|13|38|40)/.test(evt.keyCode)) return;\r\n          // Let tab propagate\r\n          if (evt.keyCode !== 9) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n          }\r\n\r\n          // release focus on tab\r\n          if (options.multiple && evt.keyCode === 9) {\r\n            return $select.hide();\r\n          }\r\n\r\n          // Select with enter\r\n          if (!options.multiple && (evt.keyCode === 13 || evt.keyCode === 9)) {\r\n            return $select.select(scope.$activeIndex);\r\n          }\r\n\r\n          if (!options.multiple) {\r\n            // Navigate with keyboard\r\n            if (evt.keyCode === 38 && scope.$activeIndex > 0) scope.$activeIndex--;\r\n            else if (evt.keyCode === 38 && scope.$activeIndex < 0) scope.$activeIndex = scope.$matches.length - 1;\r\n            else if (evt.keyCode === 40 && scope.$activeIndex < scope.$matches.length - 1) scope.$activeIndex++;\r\n            else if (angular.isUndefined(scope.$activeIndex)) scope.$activeIndex = 0;\r\n            scope.$digest();\r\n          }\r\n        };\r\n\r\n        $select.$isIE = function () {\r\n          var ua = $window.navigator.userAgent;\r\n          return ua.indexOf('MSIE ') > 0 || ua.indexOf('Trident/') > 0 || ua.indexOf('Edge/') > 0;\r\n        };\r\n\r\n        $select.$selectScrollFix = function (e) {\r\n          if ($document[0].activeElement.tagName === 'UL') {\r\n            e.preventDefault();\r\n            e.stopImmediatePropagation();\r\n            e.target.focus();\r\n          }\r\n        };\r\n\r\n        // Overrides\r\n\r\n        var _show = $select.show;\r\n        $select.show = function () {\r\n          _show();\r\n          if (options.multiple) {\r\n            $select.$element.addClass('select-multiple');\r\n          }\r\n          // use timeout to hookup the events to prevent\r\n          // event bubbling from being processed imediately.\r\n          $timeout(function () {\r\n            $select.$element.on(isTouch ? 'touchstart' : 'mousedown', $select.$onMouseDown);\r\n            if (options.keyboard) {\r\n              element.on('keydown', $select.$onKeyDown);\r\n            }\r\n          }, 0, false);\r\n        };\r\n\r\n        var _hide = $select.hide;\r\n        $select.hide = function () {\r\n          if (!options.multiple && angular.isUndefined(controller.$modelValue)) {\r\n            scope.$activeIndex = -1;\r\n          }\r\n          $select.$element.off(isTouch ? 'touchstart' : 'mousedown', $select.$onMouseDown);\r\n          if (options.keyboard) {\r\n            element.off('keydown', $select.$onKeyDown);\r\n          }\r\n          _hide(true);\r\n        };\r\n\r\n        return $select;\r\n\r\n      }\r\n\r\n      SelectFactory.defaults = defaults;\r\n      return SelectFactory;\r\n\r\n    };\r\n\r\n  })\r\n\r\n  .directive('bsSelect', function ($window, $parse, $q, $select, $parseOptions) {\r\n\r\n    var defaults = $select.defaults;\r\n\r\n    return {\r\n      restrict: 'EAC',\r\n      require: 'ngModel',\r\n      link: function postLink (scope, element, attr, controller) {\r\n\r\n        // Directive options\r\n        var options = {scope: scope, placeholder: defaults.placeholder};\r\n        angular.forEach(['template', 'templateUrl', 'controller', 'controllerAs', 'placement', 'container', 'delay', 'trigger', 'keyboard', 'html', 'animation', 'placeholder', 'allNoneButtons', 'maxLength', 'maxLengthHtml', 'allText', 'noneText', 'iconCheckmark', 'autoClose', 'id', 'sort', 'caretHtml', 'prefixClass', 'prefixEvent'], function (key) {\r\n          if (angular.isDefined(attr[key])) options[key] = attr[key];\r\n        });\r\n\r\n        // use string regex match boolean attr falsy values, leave truthy values be\r\n        var falseValueRegExp = /^(false|0|)$/i;\r\n        angular.forEach(['html', 'container', 'allNoneButtons', 'sort'], function (key) {\r\n          if (angular.isDefined(attr[key]) && falseValueRegExp.test(attr[key])) {\r\n            options[key] = false;\r\n          }\r\n        });\r\n\r\n        // Only parse data-multiple. Angular sets existence attributes to true (multiple/required/etc), they apply this\r\n        // to data-multiple as well for some reason, so we'll parse this ourselves and disregard multiple\r\n        var dataMultiple = element.attr('data-multiple');\r\n        if (angular.isDefined(dataMultiple)) {\r\n          if (falseValueRegExp.test(dataMultiple)) {\r\n            options.multiple = false;\r\n          } else {\r\n            options.multiple = dataMultiple;\r\n          }\r\n        }\r\n\r\n        // Add support for select markup\r\n        if (element[0].nodeName.toLowerCase() === 'select') {\r\n          var inputEl = element;\r\n          inputEl.css('display', 'none');\r\n          element = angular.element('<button type=\"button\" class=\"btn btn-default\"></button>');\r\n          inputEl.after(element);\r\n        }\r\n\r\n        // Build proper bsOptions\r\n        var parsedOptions = $parseOptions(attr.bsOptions);\r\n\r\n        // Initialize select\r\n        var select = $select(element, controller, options);\r\n\r\n        if (select.$isIE()) {\r\n          element[0].addEventListener('blur', select.$selectScrollFix);\r\n        }\r\n\r\n        // Watch bsOptions values before filtering for changes\r\n        var watchedOptions = parsedOptions.$match[7].replace(/\\|.+/, '').trim();\r\n        scope.$watch(watchedOptions, function (newValue, oldValue) {\r\n          // console.warn('scope.$watch(%s)', watchedOptions, newValue, oldValue);\r\n          parsedOptions.valuesFn(scope, controller)\r\n          .then(function (values) {\r\n            select.update(values);\r\n            controller.$render();\r\n          });\r\n        }, true);\r\n\r\n        // Watch model for changes\r\n        scope.$watch(attr.ngModel, function (newValue, oldValue) {\r\n          // console.warn('scope.$watch(%s)', attr.ngModel, newValue, oldValue);\r\n          select.$updateActiveIndex();\r\n          controller.$render();\r\n        }, true);\r\n\r\n        // Model rendering in view\r\n        controller.$render = function () {\r\n          // console.warn('$render', element.attr('ng-model'), 'controller.$modelValue', typeof controller.$modelValue, controller.$modelValue, 'controller.$viewValue', typeof controller.$viewValue, controller.$viewValue);\r\n          var selected;\r\n          var index;\r\n          if (options.multiple && angular.isArray(controller.$modelValue)) {\r\n            selected = controller.$modelValue.map(function (value) {\r\n              index = select.$getIndex(value);\r\n              return index !== -1 ? select.$scope.$matches[index].label : false;\r\n            }).filter(angular.isDefined);\r\n            if (selected.length > (options.maxLength || defaults.maxLength)) {\r\n              selected = selected.length + ' ' + (options.maxLengthHtml || defaults.maxLengthHtml);\r\n            } else {\r\n              selected = selected.join(', ');\r\n            }\r\n          } else {\r\n            index = select.$getIndex(controller.$modelValue);\r\n            selected = index !== -1 ? select.$scope.$matches[index].label : false;\r\n          }\r\n          element.html((selected || options.placeholder) + (options.caretHtml || defaults.caretHtml));\r\n        };\r\n\r\n        if (options.multiple) {\r\n          controller.$isEmpty = function (value) {\r\n            return !value || value.length === 0;\r\n          };\r\n        }\r\n\r\n        // Garbage collection\r\n        scope.$on('$destroy', function () {\r\n          if (select) select.destroy();\r\n          options = null;\r\n          select = null;\r\n        });\r\n\r\n      }\r\n    };\r\n\r\n  });\r\n"],"sourceRoot":"/source/"}